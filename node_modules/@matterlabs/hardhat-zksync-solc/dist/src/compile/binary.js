"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.compileWithBinary = void 0;
const child_process_1 = require("child_process");
async function compileWithBinary(input, config, solcPath, detectMissingLibrariesMode = false) {
    const { compilerPath, isSystem, forceEvmla } = config.settings;
    const processCommand = `${compilerPath} --standard-json ${isSystem ? '--system-mode' : ''} ${forceEvmla ? '--force-evmla' : ''} --solc ${solcPath} ${detectMissingLibrariesMode ? '--detect-missing-libraries' : ''}`;
    const output = await new Promise((resolve, reject) => {
        const process = (0, child_process_1.exec)(processCommand, {
            maxBuffer: 1024 * 1024 * 500,
        }, (err, stdout, _stderr) => {
            if (err !== null) {
                return reject(err);
            }
            resolve(stdout);
        });
        process.stdin.write(JSON.stringify(input));
        process.stdin.end();
    });
    return JSON.parse(output);
}
exports.compileWithBinary = compileWithBinary;
//# sourceMappingURL=binary.js.map